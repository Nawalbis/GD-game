#include "obstacles.h"
#include <SDL2/SDL_image.h>
#include <stdio.h>
#include <stdlib.h>


static obstacle obstacles_niveau1[] = {
    {800, 595, 45, 45, 2}, 
    {1100, 595, 45, 45, 2},  
    
    {1400, 595, 60, 45, 4},  
    {1500, 595, 45, 45, 2},  
    
    {1800, 595, 45, 45, 3}, 
    {2000, 595, 45, 45, 3},  
    
    {2300, 595, 45, 45, 1},  
    {2300, 550, 45, 45, 2},  
    {2450, 595, 70, 45, 4},  
    
    {2600, 590, 150, 50, 1},
    {2800, 590, 150, 50, 1}, 
    
    {3100, 570, 80, 70, 1},  
    {3250, 570, 80, 70, 1},  
    {3400, 595, 60, 45, 4}, 
    
    {3600, 595, 45, 45, 1}, 
    {3700, 570, 45, 70, 1},  
    {3800, 540, 45, 100, 1}, 
    {3900, 570, 45, 70, 1}, 
    {4000, 595, 45, 45, 1}, 
    
    {4250, 590, 120, 50, 1}, 
    {4450, 595, 45, 45, 3},  
    {4650, 590, 120, 50, 1}, 
    
    {4900, 595, 50, 45, 4},  
    {5050, 595, 45, 45, 2},  
    {5200, 595, 50, 45, 4},  
    {5350, 595, 45, 45, 2},  
    
    {5600, 570, 100, 70, 1},
    {5750, 570, 100, 70, 1},
    {5900, 595, 45, 45, 3},  
    
    {6150, 590, 150, 50, 1}, 
    {6350, 595, 45, 45, 2},  
    {6550, 590, 150, 50, 1}, 
    
    {6800, 615, 25, 25, 5},
};

static obstacle obstacles_niveau2[] = {
    {600, 595, 45, 45, 3},  
    {700, 595, 45, 45, 3},  
    {850, 595, 60, 45, 4},   
    {950, 595, 45, 45, 2},   

    {1200, 595, 45, 45, 1},  
    {1200, 550, 45, 45, 1},  
    {1200, 505, 45, 45, 2},  
    {1300, 595, 80, 45, 4},  
    {1400, 595, 45, 45, 1},  
    {1400, 550, 45, 45, 3}, 
    
    {1700, 595, 60, 45, 4},
    {1800, 595, 60, 45, 4},
    {1900, 595, 60, 45, 4},

    {1760, 560, 40, 80, 2},  
    {1860, 560, 40, 80, 2},
    {1960, 560, 40, 80, 2},
    

    {2200, 595, 45, 45, 3},
    {2250, 595, 45, 45, 3},
    {2400, 570, 80, 70, 1},  
    {2550, 540, 80, 100, 1}, 
    {2700, 570, 80, 70, 1},  
    {2850, 595, 45, 45, 2},  
    

    {3100, 570, 100, 70, 1},
    {3250, 570, 100, 70, 1},
    {3400, 595, 100, 45, 4}, 
    {3550, 560, 80, 80, 1},
    {3680, 560, 80, 80, 1},
    {3810, 595, 45, 45, 3},
    {3860, 595, 45, 45, 3},
    
    {4100, 540, 45, 100, 2},
    {4200, 560, 45, 80, 2},
    {4300, 580, 45, 60, 2},
    {4400, 595, 45, 45, 3},
    
    {4700, 560, 40, 80, 2},
    {4800, 560, 40, 80, 2},
    {4900, 595, 40, 45, 3},
    {4950, 595, 35, 45, 3},
    {5100, 590, 100, 50, 1},
    {5250, 560, 130, 80, 1},
    
    {5450, 595, 60, 45, 4},
    {5550, 560, 50, 80, 2},
    
    {5750, 595, 45, 45, 3},
    {5850, 590, 100, 50, 1},
    {6000, 595, 45, 45, 2},
    
    {6250, 615, 25, 25, 5},
};


static obstacle obstacles_niveau3[] = {
    {500, 595, 45, 45, 3},
    {550, 595, 45, 45, 3},
    {600, 595, 45, 45, 3},
    {750, 595, 50, 45, 4},   
    {850, 595, 45, 45, 2},
    {900, 595, 45, 45, 3},
    
    {1100, 595, 45, 45, 1},  
    {1100, 550, 45, 45, 1},  
    {1100, 505, 45, 45, 1},  
    {1100, 460, 45, 45, 3},  
    {1200, 595, 80, 45, 4},  
    

    {1350, 560, 35, 80, 2},  
    {1450, 540, 35, 100, 2}, 
    {1550, 520, 35, 120, 2}, 
    {1650, 540, 35, 100, 2}, 
    {1750, 560, 35, 80, 2},

    {1400, 595, 50, 45, 4},
    {1500, 595, 50, 45, 4},
    {1600, 595, 50, 45, 4},
    {1700, 595, 50, 45, 4},
    

    {1900, 540, 45, 100, 2},
    {2000, 560, 45, 80, 3},
    {2100, 580, 45, 60, 3},
    {2150, 595, 45, 45, 3},
    {2200, 595, 45, 45, 3},
    

    {2450, 570, 150, 70, 1}, 
    {2650, 570, 150, 70, 1},
    {2850, 570, 150, 70, 1},

    {2660, 525, 45, 45, 3},
    {2710, 525, 45, 45, 3},
    {2860, 525, 45, 45, 3},
    {2910, 525, 45, 45, 3},
    
    {3100, 595, 80, 45, 4},
    {3250, 595, 80, 45, 4},
    {3400, 595, 80, 45, 4},
    {3180, 560, 40, 80, 2},
    {3330, 560, 40, 80, 2},
    {3480, 560, 40, 80, 2},
    
    {3700, 595, 45, 45, 3},
    {3750, 595, 45, 45, 3},
    {3800, 595, 45, 45, 3},
    {3700, 550, 45, 45, 2},  
    {3750, 550, 45, 45, 2},
    {3800, 550, 45, 45, 2},
    
    {3950, 560, 45, 80, 2},
    {4000, 560, 45, 80, 2},
    {4050, 560, 45, 80, 2},
    {4100, 560, 45, 80, 2},
    
    {4250, 540, 45, 100, 2},
    {4300, 540, 45, 100, 2},
    {4350, 540, 45, 100, 2},
    {4400, 540, 45, 100, 2},
    
    {4600, 580, 40, 60, 2},
    {4700, 560, 40, 80, 2},
    {4800, 540, 40, 100, 2},
    {4900, 520, 40, 120, 2},
    
    {5050, 540, 45, 100, 3},
    {5150, 560, 45, 80, 3},
    {5250, 580, 45, 60, 3},
    {5350, 595, 45, 45, 3}, 

    {5550, 590, 100, 50, 1},
    {5700, 560, 130, 80, 1},
    {5880, 540, 150, 100, 1},
    
    {6080, 595, 60, 45, 4},
    {6150, 595, 60, 45, 4},
    {6220, 595, 60, 45, 4},
    {6290, 595, 60, 45, 4},
    
    {6180, 560, 50, 80, 2},  
    

    {6500, 615, 25, 25, 5},
};


int charger_obstacles_niveau(obstacle** out_obstacles, int niveau) {
    switch(niveau) {
        case 1:
            *out_obstacles = obstacles_niveau1;
            return sizeof(obstacles_niveau1) / sizeof(obstacle);
        case 2:
            *out_obstacles = obstacles_niveau2;
            return sizeof(obstacles_niveau2) / sizeof(obstacle);
        case 3:
            *out_obstacles = obstacles_niveau3;
            return sizeof(obstacles_niveau3) / sizeof(obstacle);
        default:
            printf("Niveau invalide : %d\n", niveau);
            *out_obstacles = obstacles_niveau1;
            return sizeof(obstacles_niveau1) / sizeof(obstacle);
    }
}

SDL_Texture* charger_texture(SDL_Renderer* renderer, int type) {
    const char* paths[] = {
        "images/images_obstacles/barre.png",
        "images/images_obstacles/bloc.png",
        "images/images_obstacles/carre.png",
        "images/images_obstacles/triangle.png",
        "images/images_obstacles/trou.png",
        "images/images_obstacles/gagne.png"
    };

    if (type < 0 || type >= 6) {
        printf("Type de texture invalide : %d\n", type);
        return NULL;
    }

    SDL_Surface* surface = IMG_Load(paths[type]);
    if (!surface) {
        printf("Erreur chargement image %s : %s\n", paths[type], IMG_GetError());
        return NULL;
    }

    SDL_Texture* texture = SDL_CreateTextureFromSurface(renderer, surface);
    SDL_FreeSurface(surface);

    if (!texture) {
        printf("Erreur creation texture : %s\n", SDL_GetError());
    }

    return texture;
}


